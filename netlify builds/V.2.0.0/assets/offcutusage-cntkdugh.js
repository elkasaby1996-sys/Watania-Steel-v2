var je=Object.defineProperty,pe=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var K=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,Ne=Object.prototype.propertyIsEnumerable;var Y=(i,d,a)=>d in i?je(i,d,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[d]=a,L=(i,d)=>{for(var a in d||(d={}))ve.call(d,a)&&Y(i,a,d[a]);if(K)for(var a of K(d))Ne.call(d,a)&&Y(i,a,d[a]);return i},P=(i,d)=>pe(i,fe(d));var O=(i,d,a)=>new Promise((h,r)=>{var p=l=>{try{f(a.next(l))}catch(t){r(t)}},y=l=>{try{f(a.throw(l))}catch(t){r(t)}},f=l=>l.done?h(l.value):Promise.resolve(l.value).then(p,y);f((a=a.apply(i,d)).next())});import{c as ie,r as u,b as re,M as F,j as e,B as S,L as $,I as E,a as le,h as H,d as X,F as ye,X as we,C as T,n as C,p as k,m as _}from"./index-ma71H6Gv.js";import{T as be,a as Te,b as q}from"./tabs-DCQNEJ-K.js";import{C as Ce,a as _e,b as De}from"./collapsible-CkpgzH8I.js";import{D as ke,b as Se,c as Ee,d as Fe,i as Ae}from"./dialog-DRm7bkZI.js";import{S as J,a as Q,b as Z,c as ee,d as G,e as Le}from"./select-DIwa_4rP.js";import{C as se}from"./CalculatorInput-D0eqxriC.js";import{T as ne}from"./trash-2-BWQ-pNma.js";import{P as ce}from"./plus-BnJ8CoYp.js";import{S as Pe}from"./save-BVsHsrDE.js";import{T as de,a as oe,b as I,c as b,d as me,e as v}from"./table-J_5NzfFx.js";import{P as $e,W as Me}from"./weight-1r70IWYE.js";import{T as Oe}from"./trending-up-elEg1KNE.js";import{l as Be,J as he,m as Ve,R as Ie,T as Re}from"./generateCategoricalChart-C3nVHDpr.js";import{X as xe,Y as ue,C as Ue}from"./YAxis-BmHm4sGQ.js";import{C as ze}from"./calendar-CO-MNXG0.js";import"./index-BHnHYWBN.js";import"./calculator-DUrzhYkl.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Ge=ie("award",We);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Xe=ie("pencil",He);var Ke=Be({chartName:"BarChart",GraphicalChild:he,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:xe},{axisType:"yAxis",AxisComp:ue}],formatAxisMap:Ve});const Ye=["8mm","10mm","12mm","14mm","16mm","18mm","20mm","25mm","32mm"];function qe({open:i,onOpenChange:d,selectedDate:a,onEntriesAdded:h}){const[r,p]=u.useState([]),[y,f]=u.useState([]),[l,t]=u.useState(!1),[j,x]=u.useState(!1),{toast:m}=re();u.useEffect(()=>{i&&(p([D()]),A())},[i,a]);const D=()=>({id:`temp-${Date.now()}-${Math.random()}`,date:a,company:"",bar_diameter:"",pieces_used:"",weight_kg:"",notes:""}),A=()=>O(null,null,function*(){t(!0);try{const s=yield F.getCompaniesForDate(a);f(s)}catch(s){console.error("Failed to load companies:",s),m({title:"Error",description:"Failed to load companies. Please try again.",variant:"destructive"})}finally{t(!1)}}),M=()=>{p([...r,D()])},n=s=>{if(r.length===1){m({title:"Cannot remove",description:"At least one entry is required",variant:"destructive"});return}p(r.filter(o=>o.id!==s))},g=(s,o,c)=>{p(r.map(w=>w.id===s?P(L({},w),{[o]:c}):w))},N=s=>{const o=parseFloat(s);return isNaN(o)?"0.000":(o/1e3).toFixed(3)},W=()=>{for(const s of r){if(!s.company)return m({title:"Validation Error",description:"Please select a company for all entries",variant:"destructive"}),!1;if(!s.bar_diameter)return m({title:"Validation Error",description:"Please select a bar diameter for all entries",variant:"destructive"}),!1;if(!s.pieces_used||isNaN(parseInt(s.pieces_used))||parseInt(s.pieces_used)<0)return m({title:"Validation Error",description:"Please enter valid pieces used for all entries",variant:"destructive"}),!1;if(!s.weight_kg||isNaN(parseFloat(s.weight_kg))||parseFloat(s.weight_kg)<0)return m({title:"Validation Error",description:"Please enter valid weight (kg) for all entries",variant:"destructive"}),!1}return!0},R=()=>O(null,null,function*(){if(W()){x(!0);try{const s=r.map(c=>({date:c.date,company:c.company,bar_diameter:c.bar_diameter,pieces_used:parseInt(c.pieces_used),weight_kg:parseFloat(c.weight_kg),notes:c.notes||void 0})),o=yield F.createBatch(s);if(!o||o.length===0)throw new Error("No entries were saved");m({title:"Success",description:`${o.length} offcut ${o.length===1?"entry":"entries"} added successfully`}),d(!1),setTimeout(()=>{h()},100)}catch(s){console.error("Failed to save offcut entries:",s),m({title:"Error",description:s instanceof Error?s.message:"Failed to save offcut entries. Please try again.",variant:"destructive"})}finally{x(!1)}}});return e.jsx(ke,{open:i,onOpenChange:d,children:e.jsxs(Se,{className:"max-w-5xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ee,{children:e.jsxs(Fe,{children:["Add Offcut Entries - ",new Date(a).toLocaleDateString()]})}),e.jsxs("div",{className:"space-y-4",children:[r.map((s,o)=>e.jsxs("div",{className:"p-4 border rounded-lg space-y-4 bg-card",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("h4",{className:"font-medium text-sm",children:["Entry ",o+1]}),r.length>1&&e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>n(s.id),className:"text-destructive hover:text-destructive",children:e.jsx(ne,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:`company-${s.id}`,children:"Company *"}),e.jsxs(J,{value:s.company,onValueChange:c=>g(s.id,"company",c),disabled:l,children:[e.jsx(Q,{id:`company-${s.id}`,children:e.jsx(Z,{placeholder:l?"Loading...":"Select company"})}),e.jsx(ee,{children:y.length===0?e.jsx(G,{value:"no-companies",disabled:!0,children:l?"Loading companies...":"No companies for this date"}):y.map(c=>e.jsx(G,{value:c,children:c},c))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:`diameter-${s.id}`,children:"Bar Diameter *"}),e.jsxs(J,{value:s.bar_diameter,onValueChange:c=>g(s.id,"bar_diameter",c),children:[e.jsx(Q,{id:`diameter-${s.id}`,children:e.jsx(Z,{placeholder:"Select diameter"})}),e.jsx(ee,{children:Ye.map(c=>e.jsx(G,{value:c,children:c},c))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:`pieces-${s.id}`,children:"Pieces Used *"}),e.jsx(se,{id:`pieces-${s.id}`,name:`pieces-${s.id}`,value:s.pieces_used,onChange:c=>g(s.id,"pieces_used",c),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:`weight-${s.id}`,children:"Weight (kg) *"}),e.jsx(se,{id:`weight-${s.id}`,name:`weight-${s.id}`,value:s.weight_kg,onChange:c=>g(s.id,"weight_kg",c),placeholder:"0.000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{children:"Weight (Tons)"}),e.jsx(E,{value:N(s.weight_kg),readOnly:!0,className:"bg-muted"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{htmlFor:`notes-${s.id}`,children:"Notes"}),e.jsx(E,{id:`notes-${s.id}`,value:s.notes,onChange:c=>g(s.id,"notes",c.target.value),placeholder:"Optional remarks"})]})]})]},s.id)),e.jsxs(S,{variant:"outline",onClick:M,className:"w-full",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Add Row"]})]}),e.jsxs(Ae,{children:[e.jsx(S,{variant:"outline",onClick:()=>d(!1),disabled:j||l,children:"Cancel"}),e.jsxs(S,{onClick:R,disabled:j||l,children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),j?"Saving...":`Save All (${r.length})`]})]})]})})}function te({entries:i,onUpdate:d}){var A,M;const{user:a}=le(),h=H((A=a==null?void 0:a.profile)==null?void 0:A.role,"edit"),r=H((M=a==null?void 0:a.profile)==null?void 0:M.role,"delete"),{toast:p}=re(),[y,f]=u.useState(null),[l,t]=u.useState({}),j=n=>{f(n.id),t({company:n.company,bar_diameter:n.bar_diameter,pieces_used:n.pieces_used,weight_kg:n.weight_kg,notes:n.notes})},x=()=>{f(null),t({})},m=n=>O(null,null,function*(){try{yield F.update(n,l),p({title:"Success",description:"Entry updated successfully"}),f(null),t({}),d()}catch(g){console.error("Failed to update entry:",g),p({title:"Error",description:"Failed to update entry. Please try again.",variant:"destructive"})}}),D=n=>O(null,null,function*(){if(confirm("Are you sure you want to delete this entry?"))try{yield F.delete(n),p({title:"Success",description:"Entry deleted successfully"}),d()}catch(g){console.error("Failed to delete entry:",g),p({title:"Error",description:"Failed to delete entry. Please try again.",variant:"destructive"})}});return i.length===0?e.jsxs("div",{className:"text-center py-12 border rounded-lg bg-muted/20",children:[e.jsx("p",{className:"text-muted-foreground",children:"No offcut entries for this date"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:'Click "Add Offcut Entries" to get started'})]}):e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(de,{children:[e.jsx(oe,{children:e.jsxs(I,{children:[e.jsx(b,{children:"Date"}),e.jsx(b,{children:"Company"}),e.jsx(b,{children:"Bar Diameter"}),e.jsx(b,{className:"text-right",children:"Pieces Used"}),e.jsx(b,{className:"text-right",children:"Weight (kg)"}),e.jsx(b,{className:"text-right",children:"Weight (Tons)"}),e.jsx(b,{children:"Notes"}),(h||r)&&e.jsx(b,{className:"text-center",children:"Actions"})]})}),e.jsx(me,{children:i.map(n=>{const g=y===n.id;return e.jsxs(I,{children:[e.jsx(v,{children:new Date(n.date).toLocaleDateString()}),e.jsx(v,{children:g?e.jsx(E,{value:l.company||"",onChange:N=>t(P(L({},l),{company:N.target.value})),className:"h-8"}):n.company}),e.jsx(v,{children:g?e.jsx(E,{value:l.bar_diameter||"",onChange:N=>t(P(L({},l),{bar_diameter:N.target.value})),className:"h-8"}):e.jsx(X,{variant:"outline",children:n.bar_diameter})}),e.jsx(v,{className:"text-right",children:g?e.jsx(E,{type:"number",value:l.pieces_used||0,onChange:N=>t(P(L({},l),{pieces_used:parseInt(N.target.value)})),className:"h-8 text-right"}):n.pieces_used}),e.jsx(v,{className:"text-right",children:g?e.jsx(E,{type:"number",step:"0.001",value:l.weight_kg||0,onChange:N=>t(P(L({},l),{weight_kg:parseFloat(N.target.value)})),className:"h-8 text-right"}):n.weight_kg.toFixed(3)}),e.jsx(v,{className:"text-right font-medium",children:n.weight_tons.toFixed(3)}),e.jsx(v,{className:"max-w-xs truncate",children:g?e.jsx(E,{value:l.notes||"",onChange:N=>t(P(L({},l),{notes:N.target.value})),className:"h-8",placeholder:"Optional notes"}):n.notes||"-"}),(h||r)&&e.jsx(v,{className:"text-center",children:g?e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>m(n.id),children:e.jsx(ye,{className:"h-4 w-4 text-green-600"})}),e.jsx(S,{variant:"ghost",size:"sm",onClick:x,children:e.jsx(we,{className:"h-4 w-4 text-red-600"})})]}):e.jsxs("div",{className:"flex gap-2 justify-center",children:[h&&e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>j(n),children:e.jsx(Xe,{className:"h-4 w-4"})}),r&&e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>D(n.id),className:"text-destructive hover:text-destructive",children:e.jsx(ne,{className:"h-4 w-4"})})]})})]},n.id)})})]})})}function ae({totals:i}){const d=i.reduce((h,r)=>h+r.total_pieces,0),a=i.reduce((h,r)=>h+r.total_tons,0);return i.length===0?e.jsxs(T,{children:[e.jsx(C,{children:e.jsx(k,{children:"Per-Diameter Totals"})}),e.jsx(_,{children:e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No data available"})})]}):e.jsxs(T,{children:[e.jsx(C,{children:e.jsx(k,{children:"Per-Diameter Totals"})}),e.jsx(_,{children:e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(de,{children:[e.jsx(oe,{children:e.jsxs(I,{children:[e.jsx(b,{children:"Bar Diameter"}),e.jsx(b,{className:"text-right",children:"Total Pieces Used"}),e.jsx(b,{className:"text-right",children:"Total Weight (Tons)"})]})}),e.jsxs(me,{children:[i.map(h=>e.jsxs(I,{children:[e.jsx(v,{children:e.jsx(X,{variant:"outline",className:"font-medium",children:h.bar_diameter})}),e.jsx(v,{className:"text-right font-medium",children:h.total_pieces.toLocaleString()}),e.jsx(v,{className:"text-right font-bold",children:h.total_tons.toFixed(3)})]},h.bar_diameter)),e.jsxs(I,{className:"bg-muted/50 font-bold",children:[e.jsx(v,{children:"Grand Total"}),e.jsx(v,{className:"text-right",children:d.toLocaleString()}),e.jsx(v,{className:"text-right",children:a.toFixed(3)})]})]})]})})})]})}function Je({entries:i,diameterTotals:d,viewMode:a}){const h=u.useMemo(()=>i.reduce((t,j)=>t+j.pieces_used,0),[i]),r=u.useMemo(()=>i.reduce((t,j)=>t+j.weight_tons,0),[i]),p=u.useMemo(()=>{if(a!=="monthly")return[];const t=new Map;i.forEach(x=>{const m=x.date;t.set(m,(t.get(m)||0)+x.weight_tons)});const j=Array.from(t.entries()).map(([x,m])=>({date:new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric"}),tons:Math.round(m*1e3)/1e3}));return j.sort((x,m)=>new Date(x.date).getTime()-new Date(m.date).getTime()),j},[i,a]),y=u.useMemo(()=>[...d].sort((x,m)=>m.total_tons-x.total_tons).slice(0,3).map((x,m)=>{const D=r>0?(x.total_tons/r*100).toFixed(1):"0.0";return{rank:m+1,diameter:x.bar_diameter,tons:x.total_tons,percentage:D}}),[d,r]),f=t=>{switch(t){case 1:return"bg-yellow-500";case 2:return"bg-gray-400";case 3:return"bg-orange-600";default:return"bg-muted"}},l=t=>{switch(t){case 1:return"default";case 2:return"secondary";case 3:return"outline";default:return"outline"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(T,{children:[e.jsxs(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium",children:"Total Pieces Used"}),e.jsx($e,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a==="daily"?"Today":"Last 30 days"})]})]}),e.jsxs(T,{children:[e.jsxs(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium",children:"Total Tons Used"}),e.jsx(Me,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.toFixed(3)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a==="daily"?"Today":"Last 30 days"})]})]}),e.jsxs(T,{children:[e.jsxs(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium",children:"Average per Entry"}),e.jsx(Oe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i.length>0?(r/i.length).toFixed(3):"0.000"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Tons per entry"})]})]})]}),a==="monthly"&&p.length>0&&e.jsxs(T,{children:[e.jsx(C,{children:e.jsx(k,{children:"Daily Usage Trend (Last 30 Days)"})}),e.jsx(_,{children:e.jsx(Ie,{width:"100%",height:300,children:e.jsxs(Ke,{data:p,children:[e.jsx(Ue,{strokeDasharray:"3 3"}),e.jsx(xe,{dataKey:"date",tick:{fontSize:12},angle:-45,textAnchor:"end",height:80}),e.jsx(ue,{label:{value:"Tons",angle:-90,position:"insideLeft"},tick:{fontSize:12}}),e.jsx(Re,{formatter:t=>[`${t.toFixed(3)} tons`,"Total"],labelStyle:{color:"#000"}}),e.jsx(he,{dataKey:"tons",fill:"hsl(var(--primary))",radius:[8,8,0,0]})]})})})]}),y.length>0&&e.jsxs(T,{children:[e.jsx(C,{children:e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5"}),"Top 3 Most Used Diameters"]})}),e.jsx(_,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:y.map(t=>e.jsxs(T,{className:"relative overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 left-0 right-0 h-1 ${f(t.rank)}`}),e.jsx(C,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(X,{variant:l(t.rank),children:["Rank #",t.rank]}),e.jsx("span",{className:"text-2xl font-bold text-muted-foreground",children:t.rank===1?"ðŸ¥‡":t.rank===2?"ðŸ¥ˆ":"ðŸ¥‰"})]})}),e.jsxs(_,{className:"space-y-2",children:[e.jsx("div",{className:"text-3xl font-bold",children:t.diameter}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Tons:"}),e.jsx("span",{className:"font-bold",children:t.tons.toFixed(3)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"% of Total:"}),e.jsxs("span",{className:"font-bold",children:[t.percentage,"%"]})]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2 mt-3",children:e.jsx("div",{className:`h-2 rounded-full ${f(t.rank)}`,style:{width:`${t.percentage}%`}})})]})]},t.rank))})})]})]})}function js(){var R;const{user:i}=le(),d=H((R=i==null?void 0:i.profile)==null?void 0:R.role,"edit"),[a,h]=u.useState(new Date().toISOString().split("T")[0]),[r,p]=u.useState("daily"),[y,f]=u.useState(!1),[l,t]=u.useState([]),[j,x]=u.useState([]),[m,D]=u.useState(!0),[A,M]=u.useState(new Map);u.useEffect(()=>{n()},[a,r]);const n=()=>O(null,null,function*(){D(!0);try{if(r==="daily"){const s=yield F.getByDate(a),o=F.calculateDiameterTotals(s);t(s),x(o)}else{const s=a,o=new Date(a);o.setDate(o.getDate()-30);const c=o.toISOString().split("T")[0],w=yield F.getByDateRange(c,s),B=F.calculateDiameterTotals(w);t(w),x(B);const U=new Map;w.forEach(z=>{const V=z.date;U.has(V)||U.set(V,[]),U.get(V).push(z)});const ge=new Map(Array.from(U.entries()).sort((z,V)=>new Date(V[0]).getTime()-new Date(z[0]).getTime()));M(ge)}}catch(s){console.error("Failed to load offcut data:",s)}finally{D(!1)}}),g=()=>{n()},N=s=>{h(s.target.value)},W=s=>{p(s)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-3xl font-bold",children:"Offcut Usage"})}),e.jsx(T,{children:e.jsx(C,{children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs($,{htmlFor:"date-picker",className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-4 w-4"}),"Select Date"]}),e.jsx(E,{id:"date-picker",type:"date",value:a,onChange:N,className:"w-auto"})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(be,{value:r,onValueChange:W,children:e.jsxs(Te,{children:[e.jsx(q,{value:"daily",children:"Daily View"}),e.jsx(q,{value:"monthly",children:"Monthly View"})]})}),d&&e.jsxs(S,{onClick:()=>f(!0),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Add Offcut Entries"]})]})]})})}),m?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading offcut data..."})]})}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{entries:l,diameterTotals:j,viewMode:r}),r==="daily"?e.jsxs(e.Fragment,{children:[e.jsxs(T,{children:[e.jsx(C,{children:e.jsxs(k,{children:["Daily Offcut Entries - ",new Date(a).toLocaleDateString()]})}),e.jsx(_,{children:e.jsx(te,{entries:l,onUpdate:n})})]}),e.jsx(ae,{totals:j})]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{totals:j}),e.jsxs(T,{children:[e.jsx(C,{children:e.jsx(k,{children:"Historical Entries (Last 30 Days)"})}),e.jsx(_,{className:"space-y-4",children:A.size===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No entries found for the last 30 days"}):Array.from(A.entries()).map(([s,o])=>{const c=o.reduce((w,B)=>w+B.weight_tons,0);return e.jsxs(Ce,{className:"border rounded-lg",children:[e.jsx(_e,{className:"w-full",children:e.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Le,{className:"h-5 w-5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:new Date(s).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[o.length," ",o.length===1?"entry":"entries"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold",children:[c.toFixed(3)," tons"]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[o.reduce((w,B)=>w+B.pieces_used,0)," pieces"]})]})]})}),e.jsx(De,{children:e.jsx("div",{className:"p-4 pt-0",children:e.jsx(te,{entries:o,onUpdate:n})})})]},s)})})]})]})]}),e.jsx(qe,{open:y,onOpenChange:f,selectedDate:a,onEntriesAdded:g})]})}export{js as OffcutUsagePage};
